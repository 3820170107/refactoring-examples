consolidate-duplicate-conditional-fragments:java

###

1. Если дублирующие участки находятся вначале веток оператора, вынесите их перед условным оператором.

2. Если такой код выполняется в конце веток, поместите его после условного оператора.

3. Если дублирующий код расположен случайным образом внутри веток, вам нужно для начала попытаться передвинуть его в начало или в конец ветки, в зависимости от того, меняет ли он результат последующего кода.

4. Дублирующий фрагмент кода более одной строки можно попытаться <a href="/extract-method">извлечь в новый метод</a>, если в этом есть смысл.



###

```
double sendEmailPromotion() {
  // ...
  if (isSpecialDeal()) {
    total = price * 0.95;
    validateEmailAddress();
    sendEmail();
  }
  else {
    validateEmailAddress();
    total = price * 0.98;
    sendEmail();
  }
}
```

###

```
double sendEmailPromotion() {
  // ...
  validateEmailAddress();
  if (isSpecialDeal()) {
    total = price * 0.95;
  }
  else {
    total = price * 0.98;
  }
  sendEmail();
}
```

###

Set step 1

Select "sendEmail();"
+ Select "validateEmailAddress();"

# Как видите, в нашем методе есть условный оператор с повторяющимся кодом в разных ветках.

# Попробуем вынести этот код за пределы условного оператора. Начнём с <code>sendEmail()</code>.

Select:
```
    sendEmail();

```

# Вызов этой функции лежит в конце обеих веток условного оператора. Это значит, что мы можем перенести вызов после условия.

Remove selected

Go to the end of "sendEmailPromotion"

Print:
```

  sendEmail();
```

#C Запускаем компиляцию и тестирование.

#S Пока что всё работает!

Select:
```
    validateEmailAddress();

```

# Теперь попытаемся вынести <code>validateEmailAddress()</code>. Эти вызовы находятся в разных местах, поэтому нужно подумать, будет ли уместно вообще их двигать. В нашем случае, валидацию можно проводить где угодно, но лучше всего – ближе к началу метода. Поэтому и перемещаем её туда.

Remove selected

Go to:
```
  // ...|||
  if
```

Print:
```

  validateEmailAddress();
```

#C Запускаем финальную компиляцию.

#S Отлично, все работает!

Set final step

#Q На этом рефакторинг можно считать оконченным. В завершение, можете посмотреть разницу между старым и новым кодом.