extract-class:csharp

###

1.ru. Создайте новый класс, который будет содержать выделенную функциональность.
1.uk. Створіть новий клас, який міститиме виділену функціональність.

2.ru. Создайте связь между старым и новым классом.
2.uk. Створіть зв'язок між старим і новим класом.

3.ru. Используйте <a href="/move-field">перемещение поля</a> и <a href="/move-method">перемещение метода</a> для каждого свойства и метода, которое вы решили переместить в новый класс.
3.uk. Використовуйте <a href="/move-field"> переміщення поля</a> і <a href="/move-method"> переміщення методу</a> для кожної властивості і методу, які ви вирішили перемістити в новий клас.

4.ru. Решите, делать ли новый класс доступным извне объекта старого класса.
4.uk. Вирішіть, чи робити новий клас доступним ззовні об'єкта старого класу.



###

```
public class Person
{
  public string Name
  {
    get;
  }
  public string OfficeAreaCode
  {
    get;
    set;
  }
  public string OfficeNumber
  {
    get;
    set;
  }

  public string GetTelephoneNumber()
  {
    return "(" + OfficeAreaCode + ") " + OfficeNumber;
  }
}
```

###

```
public class Person
{
  private TelephoneNumber officeTelephone = new TelephoneNumber();

  public string Name
  {
    get;
  }
  public TelephoneNumber OfficeTelephone
  {
    get {
      return officeTelephone;
    }
  }

  public string GetTelephoneNumber()
  {
    return officeTelephone.GetTelephoneNumber();
  }
}

public class TelephoneNumber
{
  public string AreaCode
  {
    get;
    set;
  }
  public string Number
  {
    get;
    set;
  }

  public string GetTelephoneNumber()
  {
    return "(" + AreaCode + ") " + Number;
  }
}
```

###

Set step 1

#|ru| Давайте рассмотрим <i>Извлечение класса</i> на примере простого класса, описывающего личность.
#|uk| Давайте розглянемо <i>Відокремлення  класу<i> на прикладі простого класу, що описує особистість.

Select "string |||OfficeAreaCode|||"
+ Select "string |||OfficeNumber|||"
+ Select name of "GetTelephoneNumber"

#|ru| В данном примере можно выделить в отдельный класс свойства и методы, относящиеся к телефонным номерам.
#|uk| В даному прикладі можна виділити в окремий клас властивості і методи, що відносяться до телефонних номерів.

Go to the end of file

#|ru| Начнём с определения класса телефонного номера.
#|uk| Почнемо з визначення класу телефонного номера.

Print:
```


public class TelephoneNumber
{
}
```

Set step 2

Select name of "Person"

#|ru| Это было просто! Теперь создадим ссылку из класса <code>Person</code> на класс телефонного номера.
#|uk| Це було просто! Тепер створимо посилання з класу <code>Person</code> на клас телефонного номеру.

Go to the start of "Person"

Print:
```

  private TelephoneNumber officeTelephone = new TelephoneNumber();

```

Set step 3

Select "string |||OfficeAreaCode|||"

#|ru| Всё готово, чтобы начать перемещать свойства и методы. Воспользуемся рефакторингом <a href="/move-field">перемещение поля</a>, чтобы передвинуть свойство <code>OfficeAreaCode</code> в класс <code>TelephoneNumber</code>.
#|uk| Все готово, щоб почати переміщати властивості та методи. Скористаємося рефакторингом <a href="/move-field">переміщення поля</a>, щоб пересунути властивість <code>OfficeAreaCode</code> в клас <code>TelephoneNumber</code>.

Go to the start of "TelephoneNumber"

Print:
```

  public string AreaCode
  {
    get;
    set;
  }
```

Select "AreaCode" in "TelephoneNumber"

#|ru| Заметили? Я сразу переименовал это свойство так, чтобы оно имело более нейтральное название. Это повысит наши шансы на повторное использование данного класса.
#|uk| Помітили? Я відразу перейменував цю властивість так, щоб вона мала більш нейтральну назву. Це підвищить наші шанси на повторне використання даного класу.

Select "OfficeAreaCode" in "GetTelephoneNumber"

#|ru| После того, как свойство успешно переместилось в класс <code>TelephoneNumber</code>, методы, которые использовали перемещённое свойство, необходимо изменить так, чтобы они обращались к экземпляру созданного класса.
#|uk| Після того, як властивість успішно перемістилася в клас <code>TelephoneNumber</code>, методи, які використовували переміщену властивість, необхідно змінити так, щоб вони зверталися до примірника створеного класу.

Print:
```
officeTelephone.AreaCode
```

Select:
```
  public string OfficeAreaCode
  {
    |||get|||;
    |||set|||
```

#|ru| Кроме того, если требуется сохранить свойство в исходном классе, то надо переписать его сеттер и геттер таким образом, чтобы они делегировали свойство созданного класса.
#|uk| Крім того, якщо потрібно зберегти властивість у вихідному класі, то треба переписати його сетер і геттер таким чином, щоб вони делегували властивість створеного класу.

Select:
```
  public string OfficeAreaCode
  {
    get|||;|||
```

Replace:
```
 {
      return officeTelephone.AreaCode;
    }
```

Select:
```
AreaCode;
    }
    set|||;|||
```

Replace:
```
 {
      officeTelephone.AreaCode = value;
    }
```

Select "string |||OfficeNumber|||"

#|ru|^= Итак, с <code>OfficeAreaCode</code> разобрались. Аналогичным образом переносим свойство <code>OfficeNumber</code>...
#|uk|^= Отже, з <code>OfficeAreaCode</code> розібралися. Аналогічним чином переносимо властивість <code>OfficeNumber</code>...

Go to the end of "TelephoneNumber"

Print:
```

  public string Number
  {
    get;
    set;
  }
```

Select "OfficeNumber" in "GetTelephoneNumber"

#|ru| ...и перенаправляем все обращения к нему в созданный нами класс.
#|uk| ...та перенаправляємо всі звернення до нього в створений нами клас.

Print:
```
officeTelephone.Number
```

Select:
```
  public string OfficeNumber
  {
    get;
    set;
  }

```

Select "string |||OfficeNumber|||"

Wait 500ms

Select:
```
  public string OfficeNumber
  {
    get|||;|||
```

Replace:
```
 {
      return officeTelephone.Number;
    }
```

Select:
```
Number;
    }
    set|||;|||
```

Replace:
```
 {
      officeTelephone.Number = value;
    }
```

Select name of "GetTelephoneNumber"

#|ru| Теперь осталось только перенести метод получения отформатированного номера <code>GetTelephoneNumber()</code>.
#|uk| Тепер залишилося тільки перенести метод отримання відформатованого номера <code>GetTelephoneNumber()</code>.

Go to the end of "TelephoneNumber"

Print:
```


  public string GetTelephoneNumber()
  {
    return "(" + AreaCode + ") " + Number;
  }
```

Select "TelephoneNumber |||officeTelephone|||"

#|ru| После чего мы можем делегировать всю телефонную функциональность классу <code>TelephoneNumber</code>.
#|uk| Після чого ми можемо делегувати всю телефонну функціональність класу <code>TelephoneNumber</code>.

Select body of "GetTelephoneNumber"

Replace:
```
    return officeTelephone.GetTelephoneNumber();
```

#C|ru| Выполним компиляцию, чтобы удостоверится, что код остался рабочим.
#S Всё отлично, код работает корректно.

#C|uk| Виконаємо компіляцію, щоб упевниться, що код залишився робочим.
#S Все добре, код працює коректно.

Set step 4

Select "private TelephoneNumber officeTelephone"

#|ru|+ На этом этапе осталось решить, в какой степени новый класс будет доступным для клиентов. Можно полностью скрыть класс, создав для доступа делегирующие свойства (как это сделано сейчас).
#|uk|+ На цьому етапі залишилося вирішити, якою мірою зробити новий клас доступним для клієнтів. Можна повністю приховати клас, створивши для доступу делегуючі властивості (як це зроблено зараз)...

Select:
```
  public string OfficeAreaCode
  {
    get {
      return officeTelephone.AreaCode;
    }
    set {
      officeTelephone.AreaCode = value;
    }
  }
  public string OfficeNumber
  {
    get {
      return officeTelephone.Number;
    }
    set {
      officeTelephone.Number = value;
    }
  }
```

#|ru|= А можно удалить все эти свойства и сделать класс открытым.
#|uk|= ...а можна видалити всі ці властивості і зробити клас відкритим.

Remove selected

#|ru| При этом нужно будет создать публичное свойство для связанного объекта, чтобы клиенты могли «достучаться» до него.
#|uk| При цьому потрібно буде створити публічну властивість для пов'язаного об'єкта, щоб клієнти могли достукатися до нього.

Print:
```
  public TelephoneNumber OfficeTelephone
  {
    get {
      return officeTelephone;
    }
  }
```

Select "public TelephoneNumber |||OfficeTelephone|||"

#|ru| Однако, решив сделать класс общедоступным, следует учесть опасности, связанные со ссылками. Как относиться к тому, что при открытии телефонного номера клиент сможет изменить код зоны? Такое изменение может произвести любой код, имеющий доступ к экземпляру класса через публичное свойство.
#|uk| Однак вирішивши зробити клас загальнодоступним, слід врахувати небезпеки, пов'язані з посиланнями. Як поставитися до того, що при відкритті телефонного номера клієнт може змінити код зони? Таку зміну може призвести будь-який код, який має доступ до примірника класу через публічну властивість.

#|ru| Возможны следующие варианты: <ul><li>Допускается изменение любым объектом любой части телефонного номера. В таком случае телефонный номер становится объектом-ссылкой, и следует рассмотреть <a href="/change-value-to-reference">замену значения ссылкой</a>. Доступ к телефонному номеру осуществляется через экземпляр класса <code>Person</code>.</li><li>Вы не желаете, чтобы кто-либо мог изменить телефонный номер, кроме как посредством методов экземпляра класса <code>Person</code>. Можно сделать строковые свойства телефонного номера доступными только для чтения или обеспечить доступ к нему только через соответствующий метод.</li><li>Существует также возможность клонировать экземпляр класса <code>TelephoneNumber</code> перед тем, как предоставить к нему доступ. Но это может привести к недоразумениям, потому что люди будут думать, что могут изменить его значение. Кроме того, у клиентов могут возникнуть проблемы со ссылками, если телефонный номер часто передаётся.</li></ul>
#|uk| Можливі наступні варіанти: <ul><li>Допускається зміна будь-яким об'єктом будь-якою частині телефонного номеру. У такому випадку номер стає об'єктом-посиланням, і слід розглянути <a href="/change-value-to-reference">заміну значення посиланням</a>. Доступ до телефонного номеру здійснюється через реалізацію класу <code>Person</code>.</li><li>Ви не бажаєте, щоб хто-небудь міг змінити телефонний номер, окрім як за допомогою методів екземпляра класу <code>Person </code>. Можна зробити строкові властивості телефонного номера тільки для читання. Або забезпечити доступ до нього тільки через відповідний метод.</li><li>Існує також можливість клонувати екземпляр класу <code>TelephoneNumber</code> перед тим, як надати його, але це може призвести до непорозумінь, тому що люди будуть думати , що можуть змінити його значення. При цьому можуть також виникнути проблеми з посиланнями у клієнтів, якщо телефонний номер часто передається.</li></ul>

#C|ru| Запускаем финальную компиляцию.
#S Отлично, все работает!

#C|uk| Запускаємо фінальну компіляцію.
#S Супер, все працює.

Set final step

#|ru|Q На этом рефакторинг можно считать оконченным. В завершение, можете посмотреть разницу между старым и новым кодом.
#|uk|Q На цьому рефакторинг можна вважати закінченим. На завершення, можете подивитися різницю між старим та новим кодом.