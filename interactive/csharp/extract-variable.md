extract-variable:csharp

###

1.ru. Создайте локальную переменную и передайте ей необходимое значение.
1.uk. Створіть локальну змінну і передайте їй необхідне значення.

2.ru. Замените исходное выражение вашей новой переменной.
2.uk. Замініть вихідний вираз вашої нової змінної.



###

```
double Price()
{
  // Price consists of: base price - discount + shipping cost
  return quantity * itemPrice -
    Math.Max(0, quantity - 500) * itemPrice * 0.05 +
    Math.Min(quantity * itemPrice * 0.1, 100.0);
}
```

###

```
double Price()
{
  readonly double basePrice = quantity * itemPrice;
  readonly double quantityDiscount = Math.Max(0, quantity - 500) * itemPrice * 0.05;
  readonly double shipping = Math.Min(basePrice * 0.1, 100.0);
  return basePrice - quantityDiscount + shipping;
}
```

###

Set step 1

#|ru| Давайте рассмотрим <i>Извлечение переменной</i> на примере этого простого метода.
#|uk| Давайте розглянемо <i>Відокремлення змінної<i> на прикладі цього простого методу.

#|ru| Как видите, метод состоит из одного громадного выражения, в котором сам черт ногу сломит.
#|uk| Як бачите, метод складається з одного величезного виразу, в якому сам чорт ногу зломить.

#|ru| Давайте разобьём это выражение на отдельные части, при этом каждую из частей поместим в отдельную переменную.
#|uk| Давайте розіб'ємо цей вираз на окремі частини, при цьому кожну з частин помістимо в окрему змінну.

Select "quantity * itemPrice"

#|ru| Сперва определим базовую цену <code>basePrice</code> как количество товаров в заказе, умноженное на стоимость одной единицы…
#|uk| Спершу визначимо базову ціну <code>basePrice</code> як кількість товарів в замовленні, помножене на вартість однієї одиниці...

Set step 2

Go to "shipping cost|||"

Print:
```

  readonly double basePrice = quantity * itemPrice;
```

Select 2nd "quantity * itemPrice"
+ Select 3rd "quantity * itemPrice"

#|ru| ...и применим новую переменную в формуле. Данное выражение повторяется несколько раз, поэтому заменим все одинаковые вычисления переменной.
#|uk| ...і застосуємо нову змінну у формулі. Даний вираз повторюється кілька разів, тому замінимо всі однакові обчислення змінної.

Print "basePrice"

#C|ru| Давайте запустим компиляцию и удостоверимся, что все хорошо.
#S Все отлично, можем продолжать!

#C|uk| Давайте запустимо компіляцію і переконався, що все добре.
#S Все добре, можемо продовжувати.

Select:
```
    Math.Max(0, quantity - 500) * itemPrice * 0.05 +
    Math.Min(basePrice * 0.1, 100.0);
```

#|ru| Теперь необходимо заменить переменными оставшиеся части сложного выражения.
#|uk| Тепер необхідно замінити змінними частини складного виразу, що залишилися.

Select:
```
Math.Max(0, quantity - 500) * itemPrice * 0.05
```

#|ru| Определим скидку за количество купленного товара <code>quantityDiscount</code>, а расчёт вынесем в новую переменную.
#|uk| Визначимо знижку за кількість придбанного товару <code>quantityDiscount</code>, а розрахунок винесемо в нову змінну.

Go to "quantity * itemPrice;|||"

Print:
```

  readonly double quantityDiscount = Math.Max(0, quantity - 500) * itemPrice * 0.05;
```

Select:
```

    Math.Max(0, quantity - 500) * itemPrice * 0.05
```

Replace " quantityDiscount"

#C|ru| Готово, теперь запустим компиляцию и удостоверимся, что не возникло ошибок.
#S Все отлично, можем продолжать!

#C|uk| Готово, тепер запустимо компіляцію і переконався, що не виникло помилок.
#S Все добре, можемо продовжувати.

Select:
```
Math.Min(basePrice * 0.1, 100.0)
```

#|ru| Последняя часть расчётов  – это доставка <code>shipping</code>. Здесь также используем отдельную переменную.
#|uk| Остання частина розрахунків – це доставка <code>shipping</code>. Тут також використаємо окрему змінну.

Go to "itemPrice * 0.05;|||"

Print:
```

  readonly double shipping = Math.Min(basePrice * 0.1, 100.0);
```

Select:
```

    Math.Min(basePrice * 0.1, 100.0)
```

Replace " shipping"

Select:
```
  // Price consists of: base price - discount + shipping cost

```

#|ru| Кстати, теперь выражение стало вполне очевидным, поэтому комментарий можно убрать.
#|uk| До речі, тепер вираз став цілком очевидним, тому коментар можна прибрати.

Remove selected

#C|ru| Запускаем финальную компиляцию.
#S Отлично, все работает!

#C|uk| Запускаємо фінальну компіляцію.
#S Супер, все працює.

Set final step

#|ru|Q На этом рефакторинг можно считать оконченным. В завершение, можете посмотреть разницу между старым и новым кодом.
#|uk|Q На цьому рефакторинг можна вважати закінченим. На завершення, можете подивитися різницю між старим та новим кодом.